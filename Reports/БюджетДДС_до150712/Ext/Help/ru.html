<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 8.00.7600.16385"></meta></head><body>
<p>//05 09 11</p>
<p>//врем. табл. СтатьиПриход - используется в запросах для проверки нахождения статьи в иерархии<br>ВЫБРАТЬ<br> СтатьиДоходовРасходов.Ссылка<br>ПОМЕСТИТЬ СтатьиПриход<br>ИЗ<br> Справочник.СтатьиДоходовРасходов КАК СтатьиДоходовРасходов<br>ГДЕ<br> СтатьиДоходовРасходов.ВидДоходаРасхода = ЗНАЧЕНИЕ(Перечисление.ВидыДоходаРасхода.Доход)<br>;</p>
<p>//врем. табл. СтатьиРасход- используется в запросах для проверки нахождения статьи в иерархии<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> СтатьиДоходовРасходов.Ссылка<br>ПОМЕСТИТЬ СтатьиРасход<br>ИЗ<br> Справочник.СтатьиДоходовРасходов КАК СтатьиДоходовРасходов<br>ГДЕ<br> СтатьиДоходовРасходов.ВидДоходаРасхода = ЗНАЧЕНИЕ(Перечисление.ВидыДоходаРасхода.Расход)<br>;</p>
<p>//врем. табл. СтатьиНакопление- используется в запросах для проверки нахождения статьи в иерархии<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> СтатьиДоходовРасходов.Ссылка<br>ПОМЕСТИТЬ СтатьиНакопление<br>ИЗ<br> Справочник.СтатьиДоходовРасходов КАК СтатьиДоходовРасходов<br>ГДЕ<br> СтатьиДоходовРасходов.ВидДоходаРасхода = ЗНАЧЕНИЕ(Перечисление.ВидыДоходаРасхода.Накопление)<br>;</p>
<p>//врем. табл. Месяцы- одна колонка, в строках даты начала месяцев. используется для соединения с ней других таблицы по периоду, если в других таблицах есть не все периоды за год<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> Месяцы.Месяц<br>ПОМЕСТИТЬ Месяцы<br>ИЗ<br> (ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 0) КАК Месяц<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 1)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 2)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 3)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 4)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 5)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 6)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 7)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 8)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 9)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 10)<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ДОБАВИТЬКДАТЕ(&amp;НачалоПериода, МЕСЯЦ, 11)) КАК Месяцы<br>;</p>
<p>//врем табл ТаблицаОборотов - ПЛАНОВЫЕ обороты по регистру БДР в разрезе статей. <br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ОборотыПлан.Период,<br> СУММА(ОборотыПлан.Приход) КАК Приход,<br> СУММА(ОборотыПлан.Расход) КАК Расход,<br> СУММА(ОборотыПлан.Накопление) КАК Накопление,<br> СУММА(ОборотыПлан.Приход) - СУММА(ОборотыПлан.Расход) - СУММА(ОборотыПлан.Накопление) КАК Оборот<br>ПОМЕСТИТЬ ТаблицаОборотов<br>ИЗ<br> (ВЫБРАТЬ<br>  БДРОбороты.СуммаПланОборот КАК Приход,<br>  0 КАК Расход,<br>  0 КАК Накопление,<br>  БДРОбороты.Период КАК Период<br> ИЗ<br>  РегистрНакопления.БДР.Обороты(<br>    &amp;НачалоПериода,<br>    &amp;КонецПериода,<br>    Месяц,<br>    СтатьяДоходовРасходов В ИЕРАРХИИ<br>      (ВЫБРАТЬ<br>       СтатьиПриход.Ссылка<br>      ИЗ<br>       СтатьиПриход)<br>     И Вариант = &amp;Вариант) КАК БДРОбороты<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  0,<br>  БДРОбороты.СуммаПланОборот,<br>  0,<br>  БДРОбороты.Период<br> ИЗ<br>  РегистрНакопления.БДР.Обороты(<br>    &amp;НачалоПериода,<br>    &amp;КонецПериода,<br>    Месяц,<br>    СтатьяДоходовРасходов В ИЕРАРХИИ<br>      (ВЫБРАТЬ<br>       СтатьиРасход.Ссылка<br>      ИЗ<br>       СтатьиРасход)<br>     И Вариант = &amp;Вариант) КАК БДРОбороты<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  0,<br>  0,<br>  БДРОбороты.СуммаПланОборот,<br>  БДРОбороты.Период<br> ИЗ<br>  РегистрНакопления.БДР.Обороты(<br>    &amp;НачалоПериода,<br>    &amp;КонецПериода,<br>    Месяц,<br>    СтатьяДоходовРасходов В ИЕРАРХИИ<br>      (ВЫБРАТЬ<br>       СтатьиНакопление.Ссылка<br>      ИЗ<br>       СтатьиНакопление)<br>     И Вариант = &amp;Вариант) КАК БДРОбороты) КАК ОборотыПлан</p>
<p>СГРУППИРОВАТЬ ПО<br> ОборотыПлан.Период<br>;</p>
<p>//врем табл ТаблицаОборотовФакт - ФАКТИЧЕСКИЕ обороты по регистру БДР в разрезе статей.  аналогична таблице ТаблицаОборотов<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> Месяцы.Месяц КАК Период,<br> СУММА(ЕСТЬNULL(ОборотыФакт.Приход, 0)) КАК Приход,<br> СУММА(ЕСТЬNULL(ОборотыФакт.Расход, 0)) КАК Расход,<br> СУММА(ЕСТЬNULL(ОборотыФакт.Накопление, 0)) КАК Накопление,<br> СУММА(ЕСТЬNULL(ОборотыФакт.Приход, 0)) - СУММА(ЕСТЬNULL(ОборотыФакт.Расход, 0)) - СУММА(ЕСТЬNULL(ОборотыФакт.Накопление, 0)) КАК Оборот<br>ПОМЕСТИТЬ ТаблицаОборотовФакт<br>ИЗ<br> Месяцы КАК Месяцы<br>  ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ<br>   БДРОбороты.СуммаФактОборот КАК Приход,<br>   0 КАК Расход,<br>   0 КАК Накопление,<br>   БДРОбороты.Период КАК Период<br>  ИЗ<br>   РегистрНакопления.БДР.Обороты(<br>     &amp;НачалоПериода,<br>     &amp;КонецПериода,<br>     Месяц,<br>     СтатьяДоходовРасходов В ИЕРАРХИИ<br>      (ВЫБРАТЬ<br>       СтатьиПриход.Ссылка<br>      ИЗ<br>       СтатьиПриход)) КАК БДРОбороты<br>  <br>  ОБЪЕДИНИТЬ ВСЕ<br>  <br>  ВЫБРАТЬ<br>   0,<br>   БДРОбороты.СуммаФактОборот,<br>   0,<br>   БДРОбороты.Период<br>  ИЗ<br>   РегистрНакопления.БДР.Обороты(<br>     &amp;НачалоПериода,<br>     &amp;КонецПериода,<br>     Месяц,<br>     СтатьяДоходовРасходов В ИЕРАРХИИ<br>      (ВЫБРАТЬ<br>       СтатьиРасход.Ссылка<br>      ИЗ<br>       СтатьиРасход)) КАК БДРОбороты<br>  <br>  ОБЪЕДИНИТЬ ВСЕ<br>  <br>  ВЫБРАТЬ<br>   0,<br>   0,<br>   БДРОбороты.СуммаФактОборот,<br>   БДРОбороты.Период<br>  ИЗ<br>   РегистрНакопления.БДР.Обороты(<br>     &amp;НачалоПериода,<br>     &amp;КонецПериода,<br>     Месяц,<br>     СтатьяДоходовРасходов В ИЕРАРХИИ<br>      (ВЫБРАТЬ<br>       СтатьиНакопление.Ссылка<br>      ИЗ<br>       СтатьиНакопление)) КАК БДРОбороты) КАК ОборотыФакт<br>  ПО (ОборотыФакт.Период = Месяцы.Месяц)</p>
<p>СГРУППИРОВАТЬ ПО<br> Месяцы.Месяц<br>;</p>
<p>//врем табл Остатки1 - остатки (начальный и конечный) за январь<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> ТНачОст.НачОст,<br> ТНачОст.НачОст + т.Оборот КАК КонОст,<br> ТНачОст.НачОст КАК НачОстФакт,<br> ТНачОст.НачОст + ф.Оборот КАК КонОстФакт<br>ПОМЕСТИТЬ Остатки1<br>ИЗ<br> (ВЫБРАТЬ<br>  &amp;НачалоПериода КАК Период,<br>  ДС.СуммаОстаток КАК НачОст<br> ИЗ<br>  РегистрНакопления.ДенежныеСредства.Остатки(&amp;НачалоПериода, Кошелек.ВидКошелька В (&amp;ВидКошелька)) КАК ДС) КАК ТНачОст<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 1)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 1)<br>;</p>
<p>//врем табл Остатки2 - остатки (начальный и конечный) за февраль<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки1.коност КАК начост,<br> остатки1.коност + т.Оборот КАК коност,<br> остатки1.КонОстФакт КАК начостфакт,<br> остатки1.КонОстФакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки2<br>ИЗ<br> остатки1 КАК остатки1<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 2)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 2)<br>;</p>
<p>//врем табл Остатки3 - остатки (начальный и конечный) за март<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки2.коност КАК начост,<br> остатки2.коност + т.Оборот КАК коност,<br> остатки2.коностфакт КАК начостфакт,<br> остатки2.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки3<br>ИЗ<br> остатки2 КАК остатки2<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 3)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 3)<br>;</p>
<p>//врем табл Остатки4 - остатки (начальный и конечный) за апрель<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки3.коност КАК начост,<br> остатки3.коност + т.Оборот КАК коност,<br> остатки3.коностфакт КАК начостфакт,<br> остатки3.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки4<br>ИЗ<br> остатки3 КАК остатки3<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 4)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 4)<br>;</p>
<p>//врем табл Остатки5 - остатки (начальный и конечный) за май<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки4.коност КАК начост,<br> остатки4.коност + т.Оборот КАК коност,<br> остатки4.коностфакт КАК начостфакт,<br> остатки4.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки5<br>ИЗ<br> остатки4 КАК остатки4<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 5)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 5)<br>;</p>
<p>//врем табл Остатки6 - остатки (начальный и конечный) за июнь<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки5.коност КАК начост,<br> остатки5.коност + т.Оборот КАК коност,<br> остатки5.коностфакт КАК начостфакт,<br> остатки5.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки6<br>ИЗ<br> остатки5 КАК остатки5<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 6)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 6)<br>;</p>
<p>//врем табл Остатки7 - остатки (начальный и конечный) за июль<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки6.коност КАК начост,<br> остатки6.коност + т.Оборот КАК коност,<br> остатки6.коностфакт КАК начостфакт,<br> остатки6.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки7<br>ИЗ<br> остатки6 КАК остатки6<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 7)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 7)<br>;</p>
<p>//врем табл Остатки8 - остатки (начальный и конечный) за Август<strong><br></strong>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки7.коност КАК начост,<br> остатки7.коност + т.Оборот КАК коност,<br> остатки7.коностфакт КАК начостфакт,<br> остатки7.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки8<br>ИЗ<br> остатки7 КАК остатки7<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 8)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 8)<br>;</p>
<p>//врем табл Остатки9 - остатки (начальный и конечный) за сентябрь<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки8.коност КАК начост,<br> остатки8.коност + т.Оборот КАК коност,<br> остатки8.коностфакт КАК начостфакт,<br> остатки8.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки9<br>ИЗ<br> остатки8 КАК остатки8<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 9)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 9)<br>;</p>
<p>//врем табл Остатки10 - остатки (начальный и конечный) за октябрь<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки9.коност КАК начост,<br> остатки9.коност + т.Оборот КАК коност,<br> остатки9.коностфакт КАК начостфакт,<br> остатки9.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки10<br>ИЗ<br> остатки9 КАК остатки9<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 10)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 10)<br>;</p>
<p>//врем табл Остатки11 - остатки (начальный и конечный) за ноябрь<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки10.коност КАК начост,<br> остатки10.коност + т.Оборот КАК коност,<br> остатки10.коностфакт КАК начостфакт,<br> остатки10.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки11<br>ИЗ<br> остатки10 КАК остатки10<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 11)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 11)<br>;</p>
<p>//врем табл Остатки12 - остатки (начальный и конечный) за декабрь<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> т.Период,<br> остатки11.коност КАК начост,<br> остатки11.коност + т.Оборот КАК коност,<br> остатки11.коностфакт КАК начостфакт,<br> остатки11.коностфакт + ф.Оборот КАК коностфакт<br>ПОМЕСТИТЬ остатки12<br>ИЗ<br> остатки11 КАК остатки11<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (МЕСЯЦ(т.Период) = 12)<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотовФакт КАК ф<br>  ПО (МЕСЯЦ(ф.Период) = 12)<br>;</p>
<p>//врем табл ТаблицаОстатков - из предыдущих 12 таблиц получает одну, со строками в которых находятся остатки на начало и конец каждого месяца<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ОстаткиЗаГод.Период,<br> ОстаткиЗаГод.НачОст,<br> ОстаткиЗаГод.коност,<br> ОстаткиЗаГод.НачОстФакт,<br> ОстаткиЗаГод.КонОстФакт<br>ПОМЕСТИТЬ ТаблицаОстатков<br>ИЗ<br> (ВЫБРАТЬ<br>  остатки1.Период КАК Период,<br>  остатки1.НачОстФакт КАК НачОстФакт,<br>  остатки1.КонОстФакт КАК КонОстФакт,<br>  остатки1.НачОст КАК НачОст,<br>  остатки1.коност КАК коност<br> ИЗ<br>  остатки1 КАК остатки1<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки2.Период,<br>  остатки2.начостфакт,<br>  остатки2.коностфакт,<br>  остатки2.начост,<br>  остатки2.коност<br> ИЗ<br>  остатки2 КАК остатки2<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки3.Период,<br>  остатки3.начостфакт,<br>  остатки3.коностфакт,<br>  остатки3.начост,<br>  остатки3.коност<br> ИЗ<br>  остатки3 КАК остатки3<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки4.Период,<br>  остатки4.начостфакт,<br>  остатки4.коностфакт,<br>  остатки4.начост,<br>  остатки4.коност<br> ИЗ<br>  остатки4 КАК остатки4<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки5.Период,<br>  остатки5.начостфакт,<br>  остатки5.коностфакт,<br>  остатки5.начост,<br>  остатки5.коност<br> ИЗ<br>  остатки5 КАК остатки5<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки6.Период,<br>  остатки6.начостфакт,<br>  остатки6.коностфакт,<br>  остатки6.начост,<br>  остатки6.коност<br> ИЗ<br>  остатки6 КАК остатки6<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки7.Период,<br>  остатки7.начостфакт,<br>  остатки7.коностфакт,<br>  остатки7.начост,<br>  остатки7.коност<br> ИЗ<br>  остатки7 КАК остатки7<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки8.Период,<br>  остатки8.начостфакт,<br>  остатки8.коностфакт,<br>  остатки8.начост,<br>  остатки8.коност<br> ИЗ<br>  остатки8 КАК остатки8<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки9.Период,<br>  остатки9.начостфакт,<br>  остатки9.коностфакт,<br>  остатки9.начост,<br>  остатки9.коност<br> ИЗ<br>  остатки9 КАК остатки9<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки10.Период,<br>  остатки10.начостфакт,<br>  остатки10.коностфакт,<br>  остатки10.начост,<br>  остатки10.коност<br> ИЗ<br>  остатки10 КАК остатки10<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки11.Период,<br>  остатки11.начостфакт,<br>  остатки11.коностфакт,<br>  остатки11.начост,<br>  остатки11.коност<br> ИЗ<br>  остатки11 КАК остатки11<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  остатки12.Период,<br>  остатки12.начостфакт,<br>  остатки12.коностфакт,<br>  остатки12.начост,<br>  остатки12.коност<br> ИЗ<br>  остатки12 КАК остатки12) КАК ОстаткиЗаГод<br>;</p>
<p>//врем табл ТаблицаОстатковИОборотов - соединяем таблицы остатков и оборотов<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> с.Период,<br> с.НачОст,<br> с.НачОстФакт,<br> т.Приход,<br> т.Расход,<br> т.Накопление,<br> с.коност,<br> с.КонОстФакт<br>ПОМЕСТИТЬ ТаблицаОстатковИОборотов<br>ИЗ<br> ТаблицаОстатков КАК с<br>  ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаОборотов КАК т<br>  ПО (т.Период = с.Период)<br>;</p>
<p>//врем табл НачальныеОстатки - используется для выборки первой строки отчета, в которой вместо ссылка на статью ДР находится текст "Начальный остаток"<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ТаблицаОстатков.НачОст КАК План,<br> ТаблицаОстатков.НачОстФакт КАК Факт,<br> "Начальный остаток" КАК СтатьяДР,<br> ТаблицаОстатков.Период КАК ПериодДДС<br>ПОМЕСТИТЬ НачальныеОстатки<br>ИЗ<br> ТаблицаОстатков КАК ТаблицаОстатков</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>//врем табл КонечныеОстатки- используется для выборки последней строки отчета, в которой вместо ссылка на статью ДР находится текст "Конечный остаток"<br>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ТаблицаОстатков.коност КАК План,<br> ТаблицаОстатков.КонОстФакт КАК Факт,<br> "Конечный остаток" КАК СтатьяДР,<br> ТаблицаОстатков.Период КАК ПериодДДС<br>ПОМЕСТИТЬ КонечныеОстатки<br>ИЗ<br> ТаблицаОстатков КАК ТаблицаОстатков</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ФП.СуммаПланОборот КАК План,<br> 0 КАК Факт,<br> ФП.СтатьяДоходовРасходов КАК СтатьяДР,<br> ФП.Период КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотыПланДоход<br>ИЗ<br> РегистрНакопления.БДР.Обороты(<br>   {(&amp;НачалоПериода)},<br>   {(&amp;КонецПериода)},<br>   Месяц,<br>   Вариант = &amp;Вариант<br>    И СтатьяДоходовРасходов В ИЕРАРХИИ<br>     (ВЫБРАТЬ<br>      СтатьиПриход.Ссылка<br>     ИЗ<br>      СтатьиПриход)) КАК ФП</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ФП.СуммаПланОборот КАК План,<br> 0 КАК Факт,<br> ФП.СтатьяДоходовРасходов КАК СтатьяДР,<br> ФП.Период КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотыПланРасход<br>ИЗ<br> РегистрНакопления.БДР.Обороты(<br>   {(&amp;НачалоПериода)},<br>   {(&amp;КонецПериода)},<br>   Месяц,<br>   Вариант = &amp;Вариант<br>    И СтатьяДоходовРасходов В ИЕРАРХИИ<br>     (ВЫБРАТЬ<br>      СтатьиРасход.Ссылка<br>     ИЗ<br>      СтатьиРасход)) КАК ФП</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ФП.СуммаПланОборот КАК План,<br> 0 КАК Факт,<br> ФП.СтатьяДоходовРасходов КАК СтатьяДР,<br> ФП.Период КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотыПланНакопление<br>ИЗ<br> РегистрНакопления.БДР.Обороты(<br>   {(&amp;НачалоПериода)},<br>   {(&amp;КонецПериода)},<br>   Месяц,<br>   Вариант = &amp;Вариант<br>    И СтатьяДоходовРасходов В ИЕРАРХИИ<br>     (ВЫБРАТЬ<br>      СтатьиНакопление.Ссылка<br>     ИЗ<br>      СтатьиНакопление)) КАК ФП</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> 0 КАК План,<br> ФП.СуммаФактОборот КАК Факт,<br> ФП.СтатьяДоходовРасходов КАК СтатьяДР,<br> ФП.Период КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотыФактДоход<br>ИЗ<br> РегистрНакопления.БДР.Обороты(<br>   {(&amp;НачалоПериода)},<br>   {(&amp;КонецПериода)},<br>   Месяц,<br>   СтатьяДоходовРасходов В ИЕРАРХИИ<br>    (ВЫБРАТЬ<br>     СтатьиПриход.Ссылка<br>    ИЗ<br>     СтатьиПриход)) КАК ФП</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> 0 КАК План,<br> ФП.СуммаФактОборот КАК Факт,<br> ФП.СтатьяДоходовРасходов КАК СтатьяДР,<br> ФП.Период КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотыФактРасход<br>ИЗ<br> РегистрНакопления.БДР.Обороты(<br>   {(&amp;НачалоПериода)},<br>   {(&amp;КонецПериода)},<br>   Месяц,<br>   СтатьяДоходовРасходов В ИЕРАРХИИ<br>    (ВЫБРАТЬ<br>     СтатьиРасход.Ссылка<br>    ИЗ<br>     СтатьиРасход)) КАК ФП</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> 0 КАК План,<br> ФП.СуммаФактОборот КАК Факт,<br> ФП.СтатьяДоходовРасходов КАК СтатьяДР,<br> ФП.Период КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотыФактНакопление<br>ИЗ<br> РегистрНакопления.БДР.Обороты(<br>   {(&amp;НачалоПериода)},<br>   {(&amp;КонецПериода)},<br>   Месяц,<br>   СтатьяДоходовРасходов В ИЕРАРХИИ<br>    (ВЫБРАТЬ<br>     СтатьиНакопление.Ссылка<br>    ИЗ<br>     СтатьиНакопление)) КАК ФП</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> СУММА(ОборотыДоход.План) КАК План,<br> СУММА(ОборотыДоход.Факт) КАК Факт,<br> ОборотыДоход.СтатьяДР КАК СтатьяДР,<br> ОборотыДоход.ПериодДДС КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотДоходы<br>ИЗ<br> (ВЫБРАТЬ<br>  ОборотыПланДоход.План КАК План,<br>  ОборотыПланДоход.Факт КАК Факт,<br>  ОборотыПланДоход.СтатьяДР КАК СтатьяДР,<br>  ОборотыПланДоход.ПериодДДС КАК ПериодДДС<br> ИЗ<br>  ОборотыПланДоход КАК ОборотыПланДоход<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ОборотыФактДоход.План,<br>  ОборотыФактДоход.Факт,<br>  ОборотыФактДоход.СтатьяДР,<br>  ОборотыФактДоход.ПериодДДС<br> ИЗ<br>  ОборотыФактДоход КАК ОборотыФактДоход) КАК ОборотыДоход</p>
<p>СГРУППИРОВАТЬ ПО<br> ОборотыДоход.СтатьяДР,<br> ОборотыДоход.ПериодДДС</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> СУММА(оборотыРасход.План) КАК План,<br> СУММА(оборотыРасход.Факт) КАК Факт,<br> оборотыРасход.СтатьяДР КАК СтатьяДР,<br> оборотыРасход.ПериодДДС КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотРасходы<br>ИЗ<br> (ВЫБРАТЬ<br>  ОборотыПланРасход.План КАК План,<br>  ОборотыПланРасход.Факт КАК Факт,<br>  ОборотыПланРасход.СтатьяДР КАК СтатьяДР,<br>  ОборотыПланРасход.ПериодДДС КАК ПериодДДС<br> ИЗ<br>  ОборотыПланРасход КАК ОборотыПланРасход<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ОборотыФактРасход.План,<br>  ОборотыФактРасход.Факт,<br>  ОборотыФактРасход.СтатьяДР,<br>  ОборотыФактРасход.ПериодДДС<br> ИЗ<br>  ОборотыФактРасход КАК ОборотыФактРасход) КАК оборотыРасход</p>
<p>СГРУППИРОВАТЬ ПО<br> оборотыРасход.СтатьяДР,<br> оборотыРасход.ПериодДДС</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> СУММА(ОборотыНакопление.План) КАК План,<br> СУММА(ОборотыНакопление.Факт) КАК Факт,<br> ОборотыНакопление.СтатьяДР КАК СтатьяДР,<br> ОборотыНакопление.ПериодДДС КАК ПериодДДС<br>ПОМЕСТИТЬ ОборотНакопления<br>ИЗ<br> (ВЫБРАТЬ<br>  ОборотыПланНакопление.План КАК План,<br>  ОборотыПланНакопление.Факт КАК Факт,<br>  ОборотыПланНакопление.СтатьяДР КАК СтатьяДР,<br>  ОборотыПланНакопление.ПериодДДС КАК ПериодДДС<br> ИЗ<br>  ОборотыПланНакопление КАК ОборотыПланНакопление<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ОборотыФактНакопление.План,<br>  ОборотыФактНакопление.Факт,<br>  ОборотыФактНакопление.СтатьяДР,<br>  ОборотыФактНакопление.ПериодДДС<br> ИЗ<br>  ОборотыФактНакопление КАК ОборотыФактНакопление) КАК ОборотыНакопление</p>
<p>СГРУППИРОВАТЬ ПО<br> ОборотыНакопление.СтатьяДР,<br> ОборотыНакопление.ПериодДДС</p>
<p>ИНДЕКСИРОВАТЬ ПО<br> СтатьяДР,<br> ПериодДДС<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ХХХ.План КАК План,<br> ХХХ.Факт КАК Факт,<br> ХХХ.СтатьяДР,<br> ХХХ.ПериодДДС,<br> ХХХ.НомерДляСортировки<br>ПОМЕСТИТЬ ИтоговаяТаблица<br>ИЗ<br> (ВЫБРАТЬ<br>  НачальныеОстатки.План КАК План,<br>  НачальныеОстатки.Факт КАК Факт,<br>  НачальныеОстатки.СтатьяДР КАК СтатьяДР,<br>  НачальныеОстатки.ПериодДДС КАК ПериодДДС,<br>  1 КАК НомерДляСортировки<br> ИЗ<br>  НачальныеОстатки КАК НачальныеОстатки<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ОборотДоходы.План,<br>  ОборотДоходы.Факт,<br>  ОборотДоходы.СтатьяДР,<br>  ОборотДоходы.ПериодДДС,<br>  2<br> ИЗ<br>  ОборотДоходы КАК ОборотДоходы<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ОборотРасходы.План,<br>  ОборотРасходы.Факт,<br>  ОборотРасходы.СтатьяДР,<br>  ОборотРасходы.ПериодДДС,<br>  3<br> ИЗ<br>  ОборотРасходы КАК ОборотРасходы<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  ОборотНакопления.План,<br>  ОборотНакопления.Факт,<br>  ОборотНакопления.СтатьяДР,<br>  ОборотНакопления.ПериодДДС,<br>  4<br> ИЗ<br>  ОборотНакопления КАК ОборотНакопления<br> <br> ОБЪЕДИНИТЬ ВСЕ<br> <br> ВЫБРАТЬ<br>  КонечныеОстатки.План,<br>  КонечныеОстатки.Факт,<br>  КонечныеОстатки.СтатьяДР,<br>  КонечныеОстатки.ПериодДДС,<br>  5<br> ИЗ<br>  КонечныеОстатки КАК КонечныеОстатки) КАК ХХХ<br>;</p>
<p>////////////////////////////////////////////////////////////////////////////////<br>ВЫБРАТЬ<br> ИтоговаяТаблица.План,<br> ИтоговаяТаблица.Факт,<br> ИтоговаяТаблица.СтатьяДР,<br> ИтоговаяТаблица.ПериодДДС,<br> ИтоговаяТаблица.НомерДляСортировки<br>ИЗ<br> ИтоговаяТаблица КАК ИтоговаяТаблица</p>
<p>ОБЪЕДИНИТЬ ВСЕ</p>
<p>ВЫБРАТЬ<br> ИтогиДляОтчета.План,<br> ИтогиДляОтчета.Факт,<br> ИтогиДляОтчета.СтатьяДР,<br> ИтогиДляОтчета.ПериодДДС,<br> ИтогиДляОтчета.НомерДляСортировки<br>ИЗ<br> (ВЫБРАТЬ<br>  СУММА(ИтоговаяТаблица.План) КАК План,<br>  СУММА(ИтоговаяТаблица.Факт) КАК Факт,<br>  ИтоговаяТаблица.СтатьяДР КАК СтатьяДР,<br>  ДОБАВИТЬКДАТЕ(&amp;НАчалоПериода, МЕСЯЦ, 12) КАК ПериодДДС,<br>  ИтоговаяТаблица.НомерДляСортировки КАК НомерДляСортировки<br> ИЗ<br>  ИтоговаяТаблица КАК ИтоговаяТаблица<br> ГДЕ<br>  (НЕ ИтоговаяТаблица.НомерДляСортировки В (1, 5))<br> <br> СГРУППИРОВАТЬ ПО<br>  ИтоговаяТаблица.СтатьяДР,<br>  ИтоговаяТаблица.НомерДляСортировки) КАК ИтогиДляОтчета</p>
<p>ОБЪЕДИНИТЬ ВСЕ</p>
<p>ВЫБРАТЬ<br> ИтоговаяТаблица.План,<br> ИтоговаяТаблица.Факт,<br> ИтоговаяТаблица.СтатьяДР,<br> ДОБАВИТЬКДАТЕ(&amp;НАчалоПериода, МЕСЯЦ, 12),<br> ИтоговаяТаблица.НомерДляСортировки<br>ИЗ<br> ИтоговаяТаблица КАК ИтоговаяТаблица<br>ГДЕ<br> ИтоговаяТаблица.НомерДляСортировки = 1<br> И ИтоговаяТаблица.ПериодДДС = &amp;Началопериода</p>
<p>ОБЪЕДИНИТЬ ВСЕ</p>
<p>ВЫБРАТЬ<br> ИтоговаяТаблица.План,<br> ИтоговаяТаблица.Факт,<br> ИтоговаяТаблица.СтатьяДР,<br> ДОБАВИТЬКДАТЕ(&amp;НАчалоПериода, МЕСЯЦ, 12),<br> ИтоговаяТаблица.НомерДляСортировки<br>ИЗ<br> ИтоговаяТаблица КАК ИтоговаяТаблица<br>ГДЕ<br> ИтоговаяТаблица.НомерДляСортировки = 5<br> И ИтоговаяТаблица.ПериодДДС = ДОБАВИТЬКДАТЕ(&amp;Началопериода, МЕСЯЦ, 11)</p>
<p> </p></body></html>