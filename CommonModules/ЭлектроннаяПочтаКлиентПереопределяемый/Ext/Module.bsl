
// Открытие формы редактирования нового письма.
// Параметры
// Отправитель*  - СписокЗначений, СправочникСсылка.УчетныеЗаписиЭлектроннойПочты - 
//                 учетная запись (список) с которой(которых) может быть отправлено
//                 почтовое сообщение. Если тип список значений, тогда
//                   представление - наименование учетной записи,
//                   значение - ссылка на учетную запись
//
// Получатель      - СписокЗначений, Строка:
//                   если список значений, то представление - имя получателя
//                                            значение      - почтовый адрес
//                   если строка то список почтовых адресов,
//                   в формате правильного e-mail адреса*
//
// Тема            - Строка - тема письма
// Текст           - Строка - тело письма
//
// СписокФайлов    - СписокЗначений, где
//                   представление - строка - наименование вложения
//                   значение      - ДвоичныеДанные - двоичные данные вложения
//                                 - Строка - адрес файла во временном хранилище
//                                 - Строка - путь к файлу на клиенте
//
// УдалятьФайлыПослеОтправки - булево - удалять временные файлы после отправки сообщения
//
Процедура ОткрытьФормуОтправкиПочтовогоСообщения(знач Отправитель = Неопределено,
												Получатель = Неопределено,
												Тема = "",
												Текст = "",
												СписокФайлов = Неопределено,
												УдалятьФайлыПослеОтправки = Ложь) Экспорт
	
	// Взаимодействия
	Если СтандартныеПодсистемыКлиентПовтИсп.ПараметрыРаботыКлиента().ИспользоватьВзаимодействия Тогда
		ВзаимодействияКлиент.ОткрытьФормуОтправкиПочтовогоСообщения(Отправитель,
			Получатель, Тема, Текст, СписокФайлов);
		Возврат;
	КонецЕсли;
	// Конец Взаимодействия
	
	РаботаСПочтовымиСообщениямиКлиент.ОткрытьПростуюФормуОтправкиПочтовогоСообщения(Отправитель,
			Получатель, Тема,Текст, СписокФайлов, УдалятьФайлыПослеОтправки);
	
КонецПроцедуры
