<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html xmlns:o="urn:schemas-microsoft-com:office:office"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link href="v8help://service_book/service_style" type="text/css" rel="stylesheet"></link><meta content="MSHTML 6.00.2900.5512" name="GENERATOR"></meta></head><body>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: center" align="center"><u><span style="FONT-SIZE: 14pt; FONT-FAMILY: 'Arial','sans-serif'; mso-bidi-font-size: 10.0pt; mso-ansi-language: RU"></span></u> </p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; TEXT-ALIGN: center" align="center"><u><span style="FONT-SIZE: 14pt; FONT-FAMILY: 'Arial','sans-serif'; mso-bidi-font-size: 10.0pt; mso-ansi-language: RU">Обработка <b style="mso-bidi-font-weight: normal">Консоль запросов</b> для управляемого приложения 1С 8.2<o:p></o:p></span></u></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Обработка <b style="mso-bidi-font-weight: normal">Консоль запросов</b> для управляемого приложения повторяет привычный интерфейс и большинство функционала обработки Консоль запросов для 1С 8.1. Она также позволяет получать результаты <b style="mso-bidi-font-weight: normal">пакетных запросов</b> и <b style="mso-bidi-font-weight: normal">временных таблиц</b>. Нужный состав результата выполнения выбирается в поле выбора <b style="mso-bidi-font-weight: normal">Получать результаты</b> из трех вариантов: <b style="mso-bidi-font-weight: normal">Только запросов, Запросов и временных таблиц, Только временных таблиц</b>.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Запросы исполняются как на <b style="mso-bidi-font-weight: normal">толстом</b>, так и на <b style="mso-bidi-font-weight: normal">тонком клиенте</b>, поскольку для выполнения запроса происходит обращение к серверу.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Файл запросов<o:p></o:p></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Файл запросов<span style="mso-spacerun: yes">  </span>(.</span><span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">sel</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">) для Консоли запросов управляемого режима аналогичен файлу для Консоли запросов платформы 8.1; можно открывать имеющиеся файлы запросов, разработанные в 8.1. Аналогично, файлы, созданные в Консоли управляемого режима, можно открывать в Консоли 8.1.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Конструктор запроса</span></b><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Конструктор запроса вызывается через контекстное меню поля текста запроса. Конструктор запроса в тонком клиенте недоступен - пункт меню открытия Конструктора блокируется. В толстом клиенте управляемого приложения Конструктор запроса доступен..<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Цветовое оформление</span></b><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Управляемое приложение не поддерживает подсветку ключевых слов текста запроса, поэтому весь текст запроса отображается черным цветом.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Параметры запроса</span></b><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Параметры текущего запроса вводятся на закладке <b style="mso-bidi-font-weight: normal">Параметры запроса</b> в левой верхней части формы Консоли. По кнопке <b style="mso-bidi-font-weight: normal">Заполнить</b> производится автоматическое заполнение списка параметров из текста запроса.</span><span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Можно задавать параметр типа <b style="mso-bidi-font-weight: normal">Тип</b>. Для этого нужно назначить тип параметра <b style="mso-bidi-font-weight: normal">ОписаниеТипов</b> и задать требуемый тип. Если будет задан составной тип, то будет использоваться только первое значение из состава типов.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Поле результата запроса</span></b><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Для отображения результата запроса в управляемом режиме используется поле табличного документа. Поскольку автоматически выровнять ширину таблицы результата по правому краю поля затруднительно, применяется визуальное выравнивание при помощи полосы регулирования (слайдера) <b style="mso-bidi-font-weight: normal">Ширина колонок</b> внизу формы: при перемещении ползунка вправо или влево меняется ширина сразу всех колонок таблицы результата, таким образом, можно подогнать правую границу таблицы результата под правый край формы. Ширина колонок каждого запроса сохраняется в файле запросов (.</span><span lang="EN-US" style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'">sel</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">). <o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Примечание 1. Если файл запросов последний раз редактировался в Консоли запросов 8.1, то при открытии его в Консоли управляемого приложения ширина колонки результата для всех запросов устанавливается в значение по умолчанию, так как Консоль запросов 8.1 это значение не сохраняет.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Примечание 2. В версии платформы 8.2 ниже 10 этот слайдер не работает, поэтому его надо в Конфигураторе заменить на поле ввода с кнопками регулирования (спиннер), или же обновить версию платформы.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Вложенные таблицы</span></b><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Вложенные таблицы (когда поле результата запроса само имеет тип РезультатЗапроса) отображаются зеленой надписью &lt;РЕЗУЛЬТАТ ЗАПРОСА&gt; в ячейке поля результата. Вложенная таблица открывается двойным щелчком в виде табличного документа.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Пакетные запросы<o:p></o:p></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Поименованные результаты пакетных запросов выводятся в поле результата один под другим. Способ выгрузки и ширина колонок одинаковы для результатов всех запросов пакета. <o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Временные таблицы<o:p></o:p></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Если выбрано получение временных таблиц, то после выполнения запроса в тексте запросов ищутся все имена временных таблиц, и для каждой поочередно выполняется выборка, результат которой выводится. Если в пакетном запросе имеются предложения УНИЧТОЖИТЬ,<span style="mso-spacerun: yes">  </span>то для уничтоженных таблиц выводится сообщение об ошибке.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Выполнение выделенного текста<o:p></o:p></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Если выделить фрагмент текста в поле текста запроса, то, выбрав пункт контекстного меню <b style="mso-bidi-font-weight: normal">Выполнить выделенный текст</b>, можно выполнить выделенный фрагмент как самостоятельный запрос. Это позволяет выполнять отдельные запросы пакета и вложенные запросы. Конечно, нужно следить, чтобы выделенный текст представлял синтаксически правильный запрос.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><b style="mso-bidi-font-weight: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Переподчинение запроса в дереве запросов<o:p></o:p></span></b></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU">Для переноса запроса в другую ветвь дерева нужно выполнить перетаскивание мышью этого запроса на новую родительскую ветвь. Производится контроль возможности зацикливания подчинения, в этом случае выдается предупреждение и переподчинение не выполняется.<o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<div style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 1pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1.5pt solid; mso-element: para-border-div">
<p class="MsoNormal" style="BORDER-RIGHT: medium none; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; PADDING-LEFT: 0cm; PADDING-BOTTOM: 0cm; MARGIN: 0cm 0cm 0pt; BORDER-LEFT: medium none; PADDING-TOP: 0cm; BORDER-BOTTOM: medium none; mso-border-bottom-alt: solid windowtext 1.5pt; mso-padding-alt: 0cm 0cm 1.0pt 0cm"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p></div>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial CYR','sans-serif'; mso-ansi-language: RU">©<i style="mso-bidi-font-style: normal">Николай Больсунов,<o:p></o:p></i></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><i style="mso-bidi-font-style: normal"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial CYR','sans-serif'; mso-ansi-language: RU"><span style="mso-spacerun: yes"> </span>январь-апрель 2010г.<o:p></o:p></span></i></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Arial CYR','sans-serif'; mso-ansi-language: RU"><a href="mailto:occam@mail.ru"><font face="Times New Roman"><span lang="EN-US" style="mso-ansi-language: EN-US; mso-bidi-font-family: 'Arial CYR'">occam</span><span style="mso-bidi-font-family: 'Arial CYR'">@</span><span lang="EN-US" style="mso-ansi-language: EN-US; mso-bidi-font-family: 'Arial CYR'">mail</span><span style="mso-bidi-font-family: 'Arial CYR'">.</span><span lang="EN-US" style="mso-ansi-language: EN-US; mso-bidi-font-family: 'Arial CYR'">ru</span></font></a><o:p></o:p></span></p>
<p class="MsoNormal" style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 8.5pt; FONT-FAMILY: 'MS Shell Dlg','sans-serif'; mso-ansi-language: RU"><o:p> </o:p></span></p></body></html>